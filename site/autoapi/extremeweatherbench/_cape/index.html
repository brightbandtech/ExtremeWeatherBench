
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Brightband PBC">
      
      
        <link rel="canonical" href="https://extremeweatherbench.readthedocs.io/autoapi/extremeweatherbench/_cape/">
      
      
        <link rel="prev" href="../">
      
      
        <link rel="next" href="../calc/">
      
      
        
      
      
      <link rel="icon" href="../../../_static/bb.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>_cape - ExtremeWeatherBench</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.618322db.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=DM+Sans:300,300i,400,400i,700,700i%7CDM+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"DM Sans";--md-code-font:"DM Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#extremeweatherbench._cape" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="ExtremeWeatherBench" class="md-header__button md-logo" aria-label="ExtremeWeatherBench" data-md-component="logo">
      <img id="logo_dark_mode" src="../../../_static/bb_light.svg" alt="logo">
<img id="logo_light_mode" src="../../../_static/bb_dark.svg" alt="logo">
    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ExtremeWeatherBench
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              _cape
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M15 13h1.5v2.82l2.44 1.41-.75 1.3L15 16.69zm3.13-3.67C17.23 6.81 14.83 5 12 5 9.3 5 7 6.65 6 9c-2.76 0-5 2.24-5 5s2.24 5 5 5h3.68c1.13 2.36 3.53 4 6.32 4 3.87 0 7-3.13 7-7 0-3.12-2.04-5.76-4.87-6.67M6 17c-1.66 0-3-1.34-3-3s1.34-3 3-3c.37 0 .73.07 1.06.19A5.004 5.004 0 0 1 12 7c1.63 0 3.07.79 4 2-3.88 0-7 3.14-7 7 0 .34.03.67.08 1zm10 4c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="bb-light" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="bb-dark" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/brightbandtech/extremeweatherbench" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    brightbandtech/extremeweatherbench
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="ExtremeWeatherBench" class="md-nav__button md-logo" aria-label="ExtremeWeatherBench" data-md-component="logo">
      <img id="logo_dark_mode" src="../../../_static/bb_light.svg" alt="logo">
<img id="logo_light_mode" src="../../../_static/bb_dark.svg" alt="logo">
    </a>
    ExtremeWeatherBench
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/brightbandtech/extremeweatherbench" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    brightbandtech/extremeweatherbench
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Installation
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../usage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Usage
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../parallelism/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    A Note on Parallelism
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Event Categories
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Event Categories
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../events/AllCaseStudies/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    All Case Studies
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Atmospheric Rivers
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Atmospheric Rivers
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../events/AtmosphericRivers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../events/atmospheric_rivers/november_2024_west_coast_us/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    November 2024 West Coast US
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../events/ConvectiveWx/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Severe Convection
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../events/Derechos/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Derechos
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../events/Flooding/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Flooding
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../events/FreezeEvents/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Freezes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../events/Heatwaves/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Heatwaves
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../events/OtherFloods/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Other Floods
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../events/TropicalCyclones/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tropical Cyclones
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../events/TCFloods/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tropical Cyclone Flooding
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../events/TCTornadoOutbreaks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tropical Cyclone Tornadic Outbreaks
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../events/WindEvents/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Wind Events
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../events/WinterWeather/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Winter Weather
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Cookbook
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Cookbook
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../recipes/cira_forecast/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CIRA Forecast
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../recipes/your_own_forecast/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    BYOF (Bring Your Own Forecast)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../recipes/your_own_target/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    BYOT (Bring Your Own Target)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../recipes/your_own_metrics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    BYOM (Bring Your Own Metrics)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../recipes/your_own_variable/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    BYOV (Bring Your Own Variable)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../recipes/evaluate_recent_tropical_cyclones/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Evaluate Recent Tropical Cyclones
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../recipes/near_real_time_point_observations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Near Real-Time Point Observations
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../recipes/single_case/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Single Case
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../recipes/one_forecast_two_targets/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    One Forecast, Two Targets
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../recipes/multi_model_evaluation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Multi Model Evaluation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../contributing.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Contributing
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../license.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    License
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" checked>
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    API Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            
  
    API Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_1" checked>
        
          
          <label class="md-nav__link" for="__nav_9_1" id="__nav_9_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    extremeweatherbench
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_9_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    extremeweatherbench
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    _cape
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    _cape
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#extremeweatherbench._cape" class="md-nav__link">
    <span class="md-ellipsis">
      
        _cape
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extremeweatherbench._cape.compute_buoyancy_energy_inline" class="md-nav__link">
    <span class="md-ellipsis">
      
        compute_buoyancy_energy_inline
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extremeweatherbench._cape.compute_ml_cape_cin_batched" class="md-nav__link">
    <span class="md-ellipsis">
      
        compute_ml_cape_cin_batched
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extremeweatherbench._cape.compute_ml_cape_cin_from_profile" class="md-nav__link">
    <span class="md-ellipsis">
      
        compute_ml_cape_cin_from_profile
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extremeweatherbench._cape.insert_lcl_level" class="md-nav__link">
    <span class="md-ellipsis">
      
        insert_lcl_level
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extremeweatherbench._cape.lcl" class="md-nav__link">
    <span class="md-ellipsis">
      
        lcl
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extremeweatherbench._cape.mixing_ratio_inline" class="md-nav__link">
    <span class="md-ellipsis">
      
        mixing_ratio_inline
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extremeweatherbench._cape.moist_ascent" class="md-nav__link">
    <span class="md-ellipsis">
      
        moist_ascent
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extremeweatherbench._cape.potential_temperature_inline" class="md-nav__link">
    <span class="md-ellipsis">
      
        potential_temperature_inline
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extremeweatherbench._cape.saturation_vapor_pressure_inline" class="md-nav__link">
    <span class="md-ellipsis">
      
        saturation_vapor_pressure_inline
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extremeweatherbench._cape.temperature_from_theta_inline" class="md-nav__link">
    <span class="md-ellipsis">
      
        temperature_from_theta_inline
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extremeweatherbench._cape.virtual_temperature_inline" class="md-nav__link">
    <span class="md-ellipsis">
      
        virtual_temperature_inline
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../calc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    calc
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cases/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    cases
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../defaults/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    defaults
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../derived/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    derived
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../evaluate/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    evaluate
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../evaluate_cli/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    evaluate_cli
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_1_8" >
        
          
          <label class="md-nav__link" for="__nav_9_1_8" id="__nav_9_1_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    events
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_9_1_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_1_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    events
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../events/atmospheric_river/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    atmospheric_river
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../events/severe_convection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    severe_convection
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../events/tropical_cyclone/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    tropical_cyclone
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../inputs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    inputs
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../metrics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    metrics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../regions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    regions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9_1_12" >
        
          
          <label class="md-nav__link" for="__nav_9_1_12" id="__nav_9_1_12_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    sources
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_9_1_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_1_12">
            <span class="md-nav__icon md-icon"></span>
            
  
    sources
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sources/base/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    base
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sources/pandas_dataframe/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    pandas_dataframe
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sources/polars_lazyframe/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    polars_lazyframe
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sources/xarray_dataarray/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    xarray_dataarray
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sources/xarray_dataset/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    xarray_dataset
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    utils
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#extremeweatherbench._cape" class="md-nav__link">
    <span class="md-ellipsis">
      
        _cape
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extremeweatherbench._cape.compute_buoyancy_energy_inline" class="md-nav__link">
    <span class="md-ellipsis">
      
        compute_buoyancy_energy_inline
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extremeweatherbench._cape.compute_ml_cape_cin_batched" class="md-nav__link">
    <span class="md-ellipsis">
      
        compute_ml_cape_cin_batched
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extremeweatherbench._cape.compute_ml_cape_cin_from_profile" class="md-nav__link">
    <span class="md-ellipsis">
      
        compute_ml_cape_cin_from_profile
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extremeweatherbench._cape.insert_lcl_level" class="md-nav__link">
    <span class="md-ellipsis">
      
        insert_lcl_level
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extremeweatherbench._cape.lcl" class="md-nav__link">
    <span class="md-ellipsis">
      
        lcl
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extremeweatherbench._cape.mixing_ratio_inline" class="md-nav__link">
    <span class="md-ellipsis">
      
        mixing_ratio_inline
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extremeweatherbench._cape.moist_ascent" class="md-nav__link">
    <span class="md-ellipsis">
      
        moist_ascent
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extremeweatherbench._cape.potential_temperature_inline" class="md-nav__link">
    <span class="md-ellipsis">
      
        potential_temperature_inline
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extremeweatherbench._cape.saturation_vapor_pressure_inline" class="md-nav__link">
    <span class="md-ellipsis">
      
        saturation_vapor_pressure_inline
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extremeweatherbench._cape.temperature_from_theta_inline" class="md-nav__link">
    <span class="md-ellipsis">
      
        temperature_from_theta_inline
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extremeweatherbench._cape.virtual_temperature_inline" class="md-nav__link">
    <span class="md-ellipsis">
      
        virtual_temperature_inline
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>_cape</h1>

<div class="doc doc-object doc-module">



<a id="extremeweatherbench._cape"></a>
    <div class="doc doc-contents first">

        <p>Module for calculating convective available potential energy (CAPE).</p>
<p>This module implements several functions to compute CAPE from collections of
atmospheric profiles retrieved from NWP or MLWP forecast datasets. In general,
we follow the methodology implemented by MetPy <a href="https://unidata.github.io/MetPy/latest/api/generated/">1</a>, although we make a few
modifications to simplify the computation. The implementation here is most appropriate
for analyzing the coarser profiles typical of model output rather than profiles
from rawinsonde observations.</p>
<p>Users can use the functions in this module directly, although we expect that they will
find it easier to use the xarray-based interfaces in the <code>cape.py</code> module.</p>
<pre><code> metpy.calc.mixed_layer_cape_cin.html
</code></pre>












<p><span class="doc-section-title">Functions:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="compute_buoyancy_energy_inline (extremeweatherbench._cape.compute_buoyancy_energy_inline)" href="#extremeweatherbench._cape.compute_buoyancy_energy_inline">compute_buoyancy_energy_inline</a></code></b>
            –
            <div class="doc-md-description">
              <p>Safely compute buoyancy energy with divide-by-zero protection.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="compute_ml_cape_cin_batched (extremeweatherbench._cape.compute_ml_cape_cin_batched)" href="#extremeweatherbench._cape.compute_ml_cape_cin_batched">compute_ml_cape_cin_batched</a></code></b>
            –
            <div class="doc-md-description">
              <p>Automatically choose serial or parallel based on batch size.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="compute_ml_cape_cin_from_profile (extremeweatherbench._cape.compute_ml_cape_cin_from_profile)" href="#extremeweatherbench._cape.compute_ml_cape_cin_from_profile">compute_ml_cape_cin_from_profile</a></code></b>
            –
            <div class="doc-md-description">
              <p>Compute CAPE/CIN for a given thermodynamic profile.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="insert_lcl_level (extremeweatherbench._cape.insert_lcl_level)" href="#extremeweatherbench._cape.insert_lcl_level">insert_lcl_level</a></code></b>
            –
            <div class="doc-md-description">
              <p>Insert LCL as a new level in the profile for better resolution.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="lcl (extremeweatherbench._cape.lcl)" href="#extremeweatherbench._cape.lcl">lcl</a></code></b>
            –
            <div class="doc-md-description">
              <p>Fast LCL calculation with inline math, following Bolton (1980).</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="mixing_ratio_inline (extremeweatherbench._cape.mixing_ratio_inline)" href="#extremeweatherbench._cape.mixing_ratio_inline">mixing_ratio_inline</a></code></b>
            –
            <div class="doc-md-description">
              <p>Inline mixing ratio calculation with divide-by-zero protection.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="moist_ascent (extremeweatherbench._cape.moist_ascent)" href="#extremeweatherbench._cape.moist_ascent">moist_ascent</a></code></b>
            –
            <div class="doc-md-description">
              <p>Compute the temperature of a parcel that is ascending moist adiabatically from</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="potential_temperature_inline (extremeweatherbench._cape.potential_temperature_inline)" href="#extremeweatherbench._cape.potential_temperature_inline">potential_temperature_inline</a></code></b>
            –
            <div class="doc-md-description">
              <p>Inline potential temperature calculation.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="saturation_vapor_pressure_inline (extremeweatherbench._cape.saturation_vapor_pressure_inline)" href="#extremeweatherbench._cape.saturation_vapor_pressure_inline">saturation_vapor_pressure_inline</a></code></b>
            –
            <div class="doc-md-description">
              <p>Inline saturation vapor pressure calculation (Bolton 1980).</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="temperature_from_theta_inline (extremeweatherbench._cape.temperature_from_theta_inline)" href="#extremeweatherbench._cape.temperature_from_theta_inline">temperature_from_theta_inline</a></code></b>
            –
            <div class="doc-md-description">
              <p>Inline temperature from potential temperature.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="virtual_temperature_inline (extremeweatherbench._cape.virtual_temperature_inline)" href="#extremeweatherbench._cape.virtual_temperature_inline">virtual_temperature_inline</a></code></b>
            –
            <div class="doc-md-description">
              <p>Inline virtual temperature from mixing ratio.</p>
            </div>
          </li>
    </ul>





<div class="doc doc-children">










<div class="doc doc-object doc-function">


<h2 id="extremeweatherbench._cape.compute_buoyancy_energy_inline" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">compute_buoyancy_energy_inline</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">compute_buoyancy_energy_inline</span><span class="p">(</span>
    <span class="n">parcel_tv_avg</span><span class="p">,</span> <span class="n">env_tv_avg</span><span class="p">,</span> <span class="n">dz</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Safely compute buoyancy energy with divide-by-zero protection.</p>
<p>Returns 0.0 if environment virtual temperature is too small or invalid.
This handles edge cases from corrupted data or extreme atmospheric conditions.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>parcel_tv_avg</code></b>
              (<code><span title="float">float</span></code>)
          –
          <div class="doc-md-description">
            <p>The average virtual temperature of the parcel in Kelvin.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>env_tv_avg</code></b>
              (<code><span title="float">float</span></code>)
          –
          <div class="doc-md-description">
            <p>The average virtual temperature of the environment in Kelvin.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>dz</code></b>
              (<code><span title="float">float</span></code>)
          –
          <div class="doc-md-description">
            <p>The height difference in meters.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="float">float</span></code>
          –
          <div class="doc-md-description">
            <p>The buoyancy energy in J/kg.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="extremeweatherbench._cape.compute_ml_cape_cin_batched" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">compute_ml_cape_cin_batched</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">compute_ml_cape_cin_batched</span><span class="p">(</span>
    <span class="n">pressure</span><span class="p">,</span>
    <span class="n">temperature</span><span class="p">,</span>
    <span class="n">dewpoint</span><span class="p">,</span>
    <span class="n">geopotential</span><span class="p">,</span>
    <span class="n">depth</span><span class="o">=</span><span class="mf">100.0</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Automatically choose serial or parallel based on batch size.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>pressure</code></b>
              (<code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>]</code>)
          –
          <div class="doc-md-description">
            <p>2D array of shape (n_profiles, n_levels)</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>temperature</code></b>
              (<code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>]</code>)
          –
          <div class="doc-md-description">
            <p>2D array of shape (n_profiles, n_levels)</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>dewpoint</code></b>
              (<code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>]</code>)
          –
          <div class="doc-md-description">
            <p>2D array of shape (n_profiles, n_levels)</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>geopotential</code></b>
              (<code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>]</code>)
          –
          <div class="doc-md-description">
            <p>2D array of shape (n_profiles, n_levels)</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>depth</code></b>
              (<code><span title="float">float</span></code>, default:
                  <code>100.0</code>
)
          –
          <div class="doc-md-description">
            <p>Mixed layer depth in hPa</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="tuple">tuple</span>[<span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>], <span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>]]</code>
          –
          <div class="doc-md-description">
            <p>tuple of (cape_array, cin_array) each with shape (n_profiles,)</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="extremeweatherbench._cape.compute_ml_cape_cin_from_profile" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">compute_ml_cape_cin_from_profile</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">compute_ml_cape_cin_from_profile</span><span class="p">(</span>
    <span class="n">pressure</span><span class="p">,</span>
    <span class="n">temperature</span><span class="p">,</span>
    <span class="n">dewpoint</span><span class="p">,</span>
    <span class="n">geopotential</span><span class="p">,</span>
    <span class="n">depth</span><span class="o">=</span><span class="mf">100.0</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Compute CAPE/CIN for a given thermodynamic profile.</p>
<p>This function operates on a single thermodynamic profile at a time, and uses a
variety of inlined helper functions to ensure that the computation is as fast
as possible.</p>
<p>WARNING: The CIN computation is not yet implemented correctly and may give
erroneous results.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>pressure</code></b>
              (<code><span title="numpy.ndarray">ndarray</span></code>)
          –
          <div class="doc-md-description">
            <p>The pressure in hPa.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>temperature</code></b>
              (<code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>]</code>)
          –
          <div class="doc-md-description">
            <p>The temperature in Kelvin.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>dewpoint</code></b>
              (<code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>]</code>)
          –
          <div class="doc-md-description">
            <p>The dewpoint in Kelvin.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>geopotential</code></b>
              (<code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>]</code>)
          –
          <div class="doc-md-description">
            <p>The geopotential in meters.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>depth</code></b>
              (<code><span title="float">float</span></code>, default:
                  <code>100.0</code>
)
          –
          <div class="doc-md-description">
            <p>The depth of the mixed layer in hPa.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="tuple">tuple</span>[<span title="float">float</span>, <span title="float">float</span>]</code>
          –
          <div class="doc-md-description">
            <p>The CAPE and CIN in J/kg.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="extremeweatherbench._cape.insert_lcl_level" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">insert_lcl_level</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">insert_lcl_level</span><span class="p">(</span>
    <span class="n">pressure</span><span class="p">,</span>
    <span class="n">temperature</span><span class="p">,</span>
    <span class="n">dewpoint</span><span class="p">,</span>
    <span class="n">geopotential</span><span class="p">,</span>
    <span class="n">p_lcl</span><span class="p">,</span>
    <span class="n">t_lcl</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Insert LCL as a new level in the profile for better resolution.</p>
<p>This function consumes 1D profiles of pressure, temperature, dewpoint,
and geopotential and determines the index at which thermodynamic
values at the LCL should be inserted into each profile. We directly
compute the LCL pressure and temperature, and logarithmically
interpolate the dewpoint and geopotential to this level.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>pressure</code></b>
              (<code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>]</code>)
          –
          <div class="doc-md-description">
            <p>The pressure in hPa.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>temperature</code></b>
              (<code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>]</code>)
          –
          <div class="doc-md-description">
            <p>The temperature in Kelvin.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>dewpoint</code></b>
              (<code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>]</code>)
          –
          <div class="doc-md-description">
            <p>The dewpoint in Kelvin.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>geopotential</code></b>
              (<code><span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>]</code>)
          –
          <div class="doc-md-description">
            <p>The geopotential in meters.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>p_lcl</code></b>
              (<code><span title="float">float</span></code>)
          –
          <div class="doc-md-description">
            <p>The LCL pressure in hPa.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>t_lcl</code></b>
              (<code><span title="float">float</span></code>)
          –
          <div class="doc-md-description">
            <p>The LCL temperature in Kelvin.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="tuple">tuple</span>[<span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>], <span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>], <span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>], <span title="numpy.typing.NDArray">NDArray</span>[<span title="numpy.float64">float64</span>], <span title="int">int</span>]</code>
          –
          <div class="doc-md-description">
            <p>The pressure, temperature, dewpoint, geopotential, and insert index.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="extremeweatherbench._cape.lcl" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">lcl</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">lcl</span><span class="p">(</span><span class="n">pressure</span><span class="p">,</span> <span class="n">temperature</span><span class="p">,</span> <span class="n">dewpoint</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Fast LCL calculation with inline math, following Bolton (1980).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>pressure</code></b>
              (<code><span title="float">float</span></code>)
          –
          <div class="doc-md-description">
            <p>The pressure in hPa.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>temperature</code></b>
              (<code><span title="float">float</span></code>)
          –
          <div class="doc-md-description">
            <p>The temperature in Kelvin.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>dewpoint</code></b>
              (<code><span title="float">float</span></code>)
          –
          <div class="doc-md-description">
            <p>The dewpoint in Kelvin.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="tuple">tuple</span>[<span title="float">float</span>, <span title="float">float</span>]</code>
          –
          <div class="doc-md-description">
            <p>The LCL pressure and temperature in hPa and Kelvin, respectively.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="extremeweatherbench._cape.mixing_ratio_inline" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">mixing_ratio_inline</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">mixing_ratio_inline</span><span class="p">(</span><span class="n">pressure</span><span class="p">,</span> <span class="n">vapor_pressure</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Inline mixing ratio calculation with divide-by-zero protection.</p>
<p>Ensures denominator is always positive by capping vapor_pressure at
99.99% of pressure to handle supersaturation and numerical precision issues.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>pressure</code></b>
              (<code><span title="float">float</span></code>)
          –
          <div class="doc-md-description">
            <p>The pressure in hPa.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>vapor_pressure</code></b>
              (<code><span title="float">float</span></code>)
          –
          <div class="doc-md-description">
            <p>The vapor pressure in hPa.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="float">float</span></code>
          –
          <div class="doc-md-description">
            <p>The mixing ratio in kg/kg.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="extremeweatherbench._cape.moist_ascent" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">moist_ascent</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">moist_ascent</span><span class="p">(</span><span class="n">p_target</span><span class="p">,</span> <span class="n">p_lcl</span><span class="p">,</span> <span class="n">t_lcl</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Compute the temperature of a parcel that is ascending moist adiabatically from
the LCL.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>p_target</code></b>
              (<code><span title="float">float</span></code>)
          –
          <div class="doc-md-description">
            <p>The target pressure in hPa.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>p_lcl</code></b>
              (<code><span title="float">float</span></code>)
          –
          <div class="doc-md-description">
            <p>The LCL pressure in hPa.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>t_lcl</code></b>
              (<code><span title="float">float</span></code>)
          –
          <div class="doc-md-description">
            <p>The LCL temperature in Kelvin.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="float">float</span></code>
          –
          <div class="doc-md-description">
            <p>The temperature in Kelvin.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="extremeweatherbench._cape.potential_temperature_inline" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">potential_temperature_inline</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">potential_temperature_inline</span><span class="p">(</span><span class="n">temperature</span><span class="p">,</span> <span class="n">pressure</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Inline potential temperature calculation.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>temperature</code></b>
              (<code><span title="float">float</span></code>)
          –
          <div class="doc-md-description">
            <p>The temperature in Kelvin.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>pressure</code></b>
              (<code><span title="float">float</span></code>)
          –
          <div class="doc-md-description">
            <p>The pressure in hPa.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="float">float</span></code>
          –
          <div class="doc-md-description">
            <p>The potential temperature in Kelvin.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="extremeweatherbench._cape.saturation_vapor_pressure_inline" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">saturation_vapor_pressure_inline</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">saturation_vapor_pressure_inline</span><span class="p">(</span><span class="n">temperature</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Inline saturation vapor pressure calculation (Bolton 1980).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>temperature</code></b>
              (<code><span title="float">float</span></code>)
          –
          <div class="doc-md-description">
            <p>The temperature in Kelvin.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="float">float</span></code>
          –
          <div class="doc-md-description">
            <p>The saturation vapor pressure in hPa.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="extremeweatherbench._cape.temperature_from_theta_inline" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">temperature_from_theta_inline</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">temperature_from_theta_inline</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">pressure</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Inline temperature from potential temperature.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>theta</code></b>
              (<code><span title="float">float</span></code>)
          –
          <div class="doc-md-description">
            <p>The potential temperature in Kelvin.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>pressure</code></b>
              (<code><span title="float">float</span></code>)
          –
          <div class="doc-md-description">
            <p>The pressure in hPa.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="float">float</span></code>
          –
          <div class="doc-md-description">
            <p>The temperature in Kelvin.</p>
          </div>
        </li>
    </ul>


    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="extremeweatherbench._cape.virtual_temperature_inline" class="doc doc-heading">
            <span class="doc doc-object-name doc-function-name">virtual_temperature_inline</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">virtual_temperature_inline</span><span class="p">(</span><span class="n">temperature</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Inline virtual temperature from mixing ratio.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <ul>
        <li class="doc-section-item field-body">
            <b><code>temperature</code></b>
              (<code><span title="float">float</span></code>)
          –
          <div class="doc-md-description">
            <p>The temperature in Kelvin.</p>
          </div>
        </li>
        <li class="doc-section-item field-body">
            <b><code>w</code></b>
              (<code><span title="float">float</span></code>)
          –
          <div class="doc-md-description">
            <p>The mixing ratio in kg/kg.</p>
          </div>
        </li>
    </ul>


<p><span class="doc-section-title">Returns:</span></p>
    <ul>
        <li class="doc-section-item field-body">
              <code><span title="float">float</span></code>
          –
          <div class="doc-md-description">
            <p>The virtual temperature in Kelvin.</p>
          </div>
        </li>
    </ul>


    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../..", "features": ["navigation.instant", "navigation.instant.prefetch"], "search": "../../../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.e71a0d61.min.js"></script>
      
    
  </body>
</html>